<!doctype html>
<html lang="th">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>‡∏î‡∏π‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</title>

<style>
  :root{
    --blue-50: #eaf6ff;
    --blue-100: #d0edff;
    --blue-300: #66bff0;
    --blue-500: #1e90ff;
    --blue-700: #0b63b8;
    --muted: #6b7280;
  }
  *{box-sizing:border-box;font-family: Inter, "Segoe UI", Roboto, "Noto Sans", sans-serif;}
  body{margin:0;background: linear-gradient(180deg,var(--blue-50), #fff);color:#0b2540;min-height:100vh;padding:28px;}
  .container{max-width:1100px;margin:0 auto;background:linear-gradient(180deg,#ffffffcc,var(--blue-50));border-radius:12px;box-shadow:0 8px 30px rgba(14,35,80,0.08);padding:20px;}
  header{display:flex;gap:16px;align-items:center;margin-bottom:18px;}
  h1{margin:0;font-size:20px;}
  .controls{display:flex;gap:12px;align-items:center;margin:18px 0;}
  .search{flex:1;display:flex;gap:8px;align-items:center;background:#fff;border-radius:10px;padding:8px 10px;border:1px solid #dbefff;}
  .search input{border:0;outline:none;font-size:15px;padding:8px 6px;width:100%;background:transparent;}
  .btn-refresh{
    background:linear-gradient(180deg,var(--blue-500),var(--blue-700));
    color:#fff;border:0;padding:10px 14px;border-radius:10px;cursor:pointer;font-weight:600;
    box-shadow:0 6px 18px rgba(30,144,255,0.18);
  }
  .table-wrap{overflow:auto;border-radius:8px;border:1px solid #e6f4ff;background:#fff;padding:6px;}
  table{width:100%;border-collapse:collapse;font-size:14px;}
  th,td{padding:10px 12px;border-bottom:1px solid #f3f7fb;text-align:left;}
  th{background:linear-gradient(90deg,var(--blue-50),#fff);position:sticky;top:0;z-index:2;}
  .center{display:flex;align-items:center;justify-content:center;padding:20px;color:var(--muted);}
  .error{color:crimson;font-weight:600;}
  @media (max-width:640px){.controls{flex-direction:column;align-items:stretch;}}

  /* üîê popup modal */
  #adminModal {
    position: fixed;
    top:0; left:0; right:0; bottom:0;
    background: rgba(0,0,0,0.5);
    display:flex;
    align-items:center;
    justify-content:center;
    z-index:9999;
  }
  #adminModal .modal-box {
    background:#fff;
    padding:24px;
    border-radius:12px;
    box-shadow:0 8px 24px rgba(0,0,0,0.2);
    max-width:300px;
    text-align:center;
  }
  #adminModal h2 {margin:0 0 16px;font-size:18px;color:var(--blue-700);}
  #adminModal input {
    width:100%;
    padding:10px;
    margin-bottom:12px;
    border:1px solid #ccc;
    border-radius:8px;
    font-size:14px;
  }
  #adminModal button {
    width:100%;
    padding:10px;
    background:var(--blue-500);
    color:#fff;
    border:0;
    border-radius:8px;
    font-size:15px;
    cursor:pointer;
    font-weight:600;
  }
  #adminModal button:hover {background:var(--blue-700);}
</style>
</head>
<body>
  <!-- üîê popup ‡∏£‡∏´‡∏±‡∏™‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô -->
  <div id="adminModal">
    <div class="modal-box">
      <h2>‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô</h2>
      <input type="password" id="adminPass" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏£‡∏´‡∏±‡∏™‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô" />
      <button onclick="checkPassword()">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
      <p id="errorMsg" style="color:red;font-size:13px;display:none;">‡∏£‡∏´‡∏±‡∏™‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á</p>
    </div>
  </div>

  <div class="container" style="display:none;" id="mainApp">
    <header><h1>‡∏î‡∏π‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</h1></header>
    <div class="controls">
      <div class="search">
        <input id="searchName" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡∏∑‡πà‡∏≠..." />
        <button id="btnSearch" class="btn-refresh" style="padding:8px 10px;font-size:14px;">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>
      </div>
      <button id="btnReload" class="btn-refresh">‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä</button>
    </div>
    <div id="status" class="center">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏£‡∏≠‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á...</div>
    <div class="table-wrap" id="tableWrap" style="display:none;">
      <table id="dataTable">
        <thead><tr id="theadRow"></tr></thead>
        <tbody id="tbodyRows"></tbody>
      </table>
    </div>
  </div>

<script>
const ADMIN_PASSWORD = "1234";  
const adminModal = document.getElementById("adminModal");
const mainApp = document.getElementById("mainApp");
function checkPassword(){
  const input = document.getElementById("adminPass").value;
  if(input === ADMIN_PASSWORD){
    adminModal.style.display = "none";
    mainApp.style.display = "";
    fetchData();
  } else {
    document.getElementById("errorMsg").style.display = "block";
  }
}

// ---- ‡∏™‡πà‡∏ß‡∏ô‡πÄ‡∏î‡∏¥‡∏°‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ----
const DATA_URL = 'https://script.google.com/macros/s/AKfycbzGUzTFLhj3wiF9kixUeqIjp5WiSoXcARWqFtllDX4_g4UCsWdCme4xMXTFU91xtBe-XA/exec';
const statusEl = document.getElementById('status');
const tableWrap = document.getElementById('tableWrap');
const theadRow = document.getElementById('theadRow');
const tbodyRows = document.getElementById('tbodyRows');
const searchInput = document.getElementById('searchName');
const btnSearch = document.getElementById('btnSearch');
const btnReload = document.getElementById('btnReload');

let originalData = [];
let keys = []; // ‡πÄ‡∏Å‡πá‡∏ö key ‡∏Ç‡∏≠‡∏á JSON

async function fetchData(){
  statusEl.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...';
  tableWrap.style.display = 'none';
  try{
    const res = await fetch(DATA_URL);
    const data = await res.json();
    originalData = Array.isArray(data) ? data : (data.records || data.data || []);
    if(originalData.length===0){statusEl.textContent="‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•"; return;}
    keys = Object.keys(originalData[0]);
    renderTable(originalData);
    statusEl.textContent="‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡πâ‡∏ß ("+originalData.length+" ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)";
    tableWrap.style.display="";
  }catch(err){
    statusEl.innerHTML = '<span class="error">Error: '+err.message+'</span>';
  }
}

function renderTable(arr){
  theadRow.innerHTML=""; tbodyRows.innerHTML="";
  keys.forEach(k=>{let th=document.createElement("th"); th.textContent=k; theadRow.appendChild(th); });
  arr.forEach(o=>{
    let tr=document.createElement("tr");
    keys.forEach(k=>{let td=document.createElement("td"); td.textContent=o[k]||""; tr.appendChild(td); });
    tbodyRows.appendChild(tr);
  });
}

function applySearch(){
  const q = searchInput.value.toLowerCase();
  if(!q){ renderTable(originalData); return; }
  const filtered = originalData.filter(o=>{
    return keys.some(k=>(o[k]||"").toString().toLowerCase().includes(q));
  });
  renderTable(filtered);
}
btnSearch.onclick = applySearch;
btnReload.onclick = fetchData;
searchInput.onkeydown = e=>{ if(e.key==="Enter") applySearch(); }
</script>
</body>
</html>
